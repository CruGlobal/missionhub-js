!function(){"use strict";angular.module("missionhub.api",["restangular","missionhub.api.cache","missionhub.api.filters","missionhub.api.utils"])}(),function(){"use strict";function n(n,e){function r(){return personCache.person(u.currentPersonId)}function t(){var e=["all_organization_and_children","all_organizational_permissions","user","organizational_permission","permission","organizational_labels","label","interactions","email_addresses","phone_numbers","addresses"],r=$q.defer();return i({id:"me",include:e.join()}).then(function(n){var e=n.person;u.currentPersonId=e.id,personCache.person(e),organizationListCache.list(e.all_organization_and_children),currentOrg({id:e.user.primary_organization_id}).then(function(){r.resolve(e)},function(n){r.reject(n)})},function(e){n.error("Requesting your data failed due to: "+e),r.reject(e)}),r.promise}function i(n){var r=e.mhResource("people",n);return r.then(function(n){angular.forEach(n.people,function(n){personCache.person(n)})}),r}function o(n){var e=["organizational_permission","permission","organizational_labels","label","email_addresses","phone_numbers","addresses"];return i({id:n,include:e.join()})}function a(n){var e=["answer_sheets","answers"];return i({id:n,include:e.join()})}function s(n){var e=["organizational_permission","permission","organizational_labels","label","email_addresses","phone_numbers","addresses","answer_sheets","answers","interactions","interaction_type"];return i({id:n,include:e.join()})}var u={},c={currentPerson:r,getMe:t,getPeople:i,getPersonWithInfo:o,getPersonWithSurveyAnswers:a,getPersonWithEverything:s};return c}angular.module("missionhub.api").factory("people",n),n.$inject=["$log","mhResource"]}(),function(){"use strict";function n(n,e){function r(){return e.one("organizations",n.getCurrentOrganization()).get().then(function(n){return n.organization})}function t(n){return e.all("organizations").customGET().then(function(n){return n.organizations})}var i={getCurrentOrganization:r,getOrganizations:t};return i}angular.module("missionhub.api").factory("organizations",n),n.$inject=["userDetails","Restangular"]}(),function(){"use strict";function n(n){function e(e){return n.mhResource("interactions",e)}function r(n){var r={"filters[people_ids]":n},t=["initiators","interaction_type","receiver","creator","last_updater"],i=angular.extend({include:t.join()},r);return e(i)}var t={getInteractions:e,getInteractionsForPerson:r};return t}angular.module("missionhub.api").factory("interactions",n),n.$inject=["mhResource"]}(),function(){"use strict";angular.module("missionhub.api.utils",["ngResource","LocalStorageModule"])}(),function(){"use strict";function n(n){function e(){return n.get("firstName")}function r(e){return n.set("firstName",e)}function t(){return n.get("lastName")}function i(e){return n.set("lastName",e)}function o(){return n.get("personId")}function a(e){return n.set("personId",e)}function s(){return n.get("profilePicture")}function u(e){return n.set("profilePicture",e)}function c(){return n.get("currentOrganization")}function l(e){return n.set("currentOrganization",e)}function f(){n.clearAll()}var g={getFirstName:e,setFirstName:r,getLastName:t,setLastName:i,getPersonId:o,setPersonId:a,getProfilePicture:s,setProfilePicture:u,getCurrentOrganization:c,setCurrentOrganization:l,clearAll:f};return g}angular.module("missionhub.api.utils").factory("userDetails",n),n.$inject=["localStorageService"]}(),function(){"use strict";function n(n,e){function r(n){o.baseUrl=n}function t(e,r){return o.currentOrgId&&"organizations"!==e&&angular.extend(r,{organization_id:o.currentOrgId}),n(o.baseUrl+e+"/:id",{id:"@id",facebook_token:i()}).get(r).$promise}function i(){return e.token()}var o={},a={mhResource:t,setBaseUrl:r};return a}angular.module("missionhub.api.utils").factory("mhResource",n),n.$inject=["$resource","customLoginDetails"]}(),function(){"use strict";function n(n){function e(e){return void 0===e?n.localStorage.getItem(r):void(e?n.localStorage.setItem(r,e):n.localStorage.removeItem(r))}var r="facebook_token";return{token:e}}angular.module("missionhub.api.utils").factory("customLoginDetails",n),n.$inject=["$window"]}(),function(){"use strict";angular.module("missionhub.api.filters",[])}(),function(){"use strict";function n(){return function(n){if(!n)return"";var e=n.toString().trim().replace(/^\+/,"");if(e.match(/[^0-9]/))return n;var r,t,i;switch(e.length){case 10:r=1,t=e.slice(0,3),i=e.slice(3);break;case 11:r=e[0],t=e.slice(1,4),i=e.slice(4);break;case 12:r=e.slice(0,3),t=e.slice(3,5),i=e.slice(5);break;default:return n}return 1===r&&(r=""),i=i.slice(0,3)+"-"+i.slice(3),(r+" ("+t+") "+i).trim()}}angular.module("missionhub.api.filters").filter("tel",n)}(),function(){"use strict";function n(n,e){return function(r){if(!r)return"";var t=n.currentOrg(),i=e.find(t.surveys,{id:r.survey_id});return e.result(i,"title","")}}angular.module("missionhub.api.filters").filter("surveyName",n),n.$inject=["api","lodash"]}(),function(){"use strict";function n(){return function(n){if(!n||!n.phone_numbers||0===n.phone_numbers.length)return"";for(var e=0;e<n.phone_numbers.length;){if(n.phone_numbers[e].primary)return n.phone_numbers[e].number;e++}return n.phone_numbers[0].number}}angular.module("missionhub.api.filters").filter("personPrimaryPhone",n)}(),function(){"use strict";function n(){return function(n){return n&&n.first_name?n.first_name+" "+n.last_name:""}}angular.module("missionhub.api.filters").filter("personFullname",n)}(),function(){"use strict";function n(){return function(n,e){if(e=e||40,!n||!n.first_name)return"";if(n.picture)return n.picture+"?width="+e+"&height="+e;for(var r="444444",t=0,i=0;t<n.first_name.length;i=n.first_name.charCodeAt(t++)+((i<<5)-i));for(var t=0,r="";3>t;r+=("00"+(i>>8*t++&255).toString(16)).slice(-2));return"https://avatars.discourse.org/letter/"+n.first_name.slice(0,1)+"/"+r+"/"+e+".png"}}angular.module("missionhub.api.filters").filter("personAvatar",n)}(),function(){"use strict";function n(){return function(n){return n?n.initiators[0]?n.initiators[0]:n.creator?n.creator:{}:{}}}angular.module("missionhub.api.filters").filter("interactionPrimaryInitiator",n)}(),function(){"use strict";function n(){return function(n){var e="http://maps.google.com/maps?q=";return n.address1&&(e+=n.address1+"+"),n.address2&&(e+=n.address2+"+"),n.city&&(e+=n.city+",+"),n.state&&(e+=n.state+"+"),n.country&&(e+=n.country),e.lastIndexOf("+")===e.length-1&&(e=e.slice(0,-1)),e}}angular.module("missionhub.api.filters").filter("googleMapsAddress",n)}(),function(){"use strict";function n(){return function(n){return"background-image: url("+n+")"}}angular.module("missionhub.api.filters").filter("backgroundStyle",n)}(),function(){"use strict";angular.module("missionhub.api.cache",[])}(),function(){"use strict";function n(){function n(n){return n.id?(e[n.id]=e[n.id]||{},angular.merge(e[n.id],n),!0):e[n]}var e={};return{person:n}}angular.module("missionhub.api.cache").factory("personCache",n)}(),function(){"use strict";function n(){function n(n){return n.id?(e[n.id]=e[n.id]||{},angular.merge(e[n.id],n),!0):e[n]}var e={};return{organization:n}}angular.module("missionhub.api.cache").factory("organizationCache",n)}(),function(){"use strict";function n(){function n(n){return n&&n.length?0===n.length?0===e.length:(e=[],angular.merge(e,n),!0):angular.extend([],e)}var e=[];return{list:n}}angular.module("missionhub.api.cache").factory("organizationListCache",n)}(),function(){"use strict";function n(n,e){function r(n,e,r,i){function o(){n.setBaseUrl(a.baseUrl)}var a={baseUrl:t.baseUrl,currentPerson:e.currentPerson,people:{get:e.getPeople,getMe:e.getMe,getPersonWithEverything:e.getPersonWithEverything,getPersonWithInfo:e.getPersonWithInfo,getPersonWithSurveyAnswers:e.getPersonWithSurveyAnswers},interactions:{get:i.getInteractions,getInteractionsForPerson:i.getInteractionsForPerson},organizations:{all:r.getOrganizations,current:r.getCurrentOrganization}};return o(),a}var t={$get:r};return Object.defineProperties(t,{baseUrl:{get:function(){return n.baseUrl},set:function(r){n.baseUrl=r,e.setBaseUrl(r)}}}),r.$inject=["mhResource","people","organizations","interactions"],t}angular.module("missionhub.api").provider("api",n),n.$inject=["apiConfig","RestangularProvider"]}(),function(){"use strict";angular.module("missionhub.api").constant("apiConfig",{baseUrl:"/"})}(),function(){"use strict";function n(n){n.setPrefix("mh.user")}angular.module("missionhub.api").config(n),n.$inject=["localStorageServiceProvider"]}();