!function(){"use strict";angular.module("missionhub.api.filters",[])}(),function(){"use strict";function n(){return function(n){if(!n)return"";var r=n.toString().trim().replace(/^\+/,"");if(r.match(/[^0-9]/))return n;var e,i,t;switch(r.length){case 10:e=1,i=r.slice(0,3),t=r.slice(3);break;case 11:e=r[0],i=r.slice(1,4),t=r.slice(4);break;case 12:e=r.slice(0,3),i=r.slice(3,5),t=r.slice(5);break;default:return n}return 1===e&&(e=""),t=t.slice(0,3)+"-"+t.slice(3),(e+" ("+i+") "+t).trim()}}angular.module("missionhub.api.filters").filter("tel",n)}(),function(){"use strict";function n(n,r){return function(e){if(!e)return"";var i=n.currentOrg(),t=r.find(i.surveys,{id:e.survey_id});return r.result(t,"title","")}}angular.module("missionhub.api.filters").filter("surveyName",n),n.$inject=["api","lodash"]}(),function(){"use strict";function n(){return function(n){if(!n||!n.phone_numbers||0===n.phone_numbers.length)return"";for(var r=0;r<n.phone_numbers.length;){if(n.phone_numbers[r].primary)return n.phone_numbers[r].number;r++}return n.phone_numbers[0].number}}angular.module("missionhub.api.filters").filter("personPrimaryPhone",n)}(),function(){"use strict";function n(){return function(n){return n&&n.first_name?n.first_name+" "+n.last_name:""}}angular.module("missionhub.api.filters").filter("personFullname",n)}(),function(){"use strict";function n(){return function(n,r){if(r=r||40,!n||!n.first_name)return"";if(n.picture)return n.picture+"?width="+r+"&height="+r;for(var e="444444",i=0,t=0;i<n.first_name.length;t=n.first_name.charCodeAt(i++)+((t<<5)-t));for(var i=0,e="";3>i;e+=("00"+(t>>8*i++&255).toString(16)).slice(-2));return"https://avatars.discourse.org/letter/"+n.first_name.slice(0,1)+"/"+e+"/"+r+".png"}}angular.module("missionhub.api.filters").filter("personAvatar",n)}(),function(){"use strict";function n(){return function(n){return n?n.initiators[0]?n.initiators[0]:n.creator?n.creator:{}:{}}}angular.module("missionhub.api.filters").filter("interactionPrimaryInitiator",n)}(),function(){"use strict";function n(){return function(n){var r="http://maps.google.com/maps?q=";return n.address1&&(r+=n.address1+"+"),n.address2&&(r+=n.address2+"+"),n.city&&(r+=n.city+",+"),n.state&&(r+=n.state+"+"),n.country&&(r+=n.country),r.lastIndexOf("+")===r.length-1&&(r=r.slice(0,-1)),r}}angular.module("missionhub.api.filters").filter("googleMapsAddress",n)}(),function(){"use strict";function n(){return function(n){return"background-image: url("+n+")"}}angular.module("missionhub.api.filters").filter("backgroundStyle",n)}(),function(){"use strict";angular.module("missionhub.api.cache",[])}(),function(){"use strict";function n(){function n(n){return n.id?(r[n.id]=r[n.id]||{},angular.merge(r[n.id],n),!0):r[n]}var r={};return{person:n}}angular.module("missionhub.api.cache").factory("personCache",n)}(),function(){"use strict";function n(){function n(n){return n.id?(r[n.id]=r[n.id]||{},angular.merge(r[n.id],n),!0):r[n]}var r={};return{organization:n}}angular.module("missionhub.api.cache").factory("organizationCache",n)}(),function(){"use strict";function n(){function n(n){return n&&n.length?0===n.length?0===r.length:(r=[],angular.merge(r,n),!0):angular.extend([],r)}var r=[];return{list:n}}angular.module("missionhub.api.cache").factory("organizationListCache",n)}(),function(){"use strict";angular.module("missionhub.api",["ngResource","missionhub.api.cache","missionhub.api.filters"])}(),function(){"use strict";function n(){function n(n){return void 0===n?localStorage.getItem(r):void(n?localStorage.setItem(r,n):localStorage.removeItem(r))}var r="facebook_token";return{token:n}}angular.module("missionhub.api").factory("loginDetails",n)}(),function(){"use strict";function n(n,r,e,i,t,o,a,s,u){function c(n,i){if(t.token())return z.currentOrgId&&"organizations"!==n&&angular.extend(i,{organization_id:z.currentOrgId}),r(o.baseUrl+n+"/:id",{id:"@id",facebook_token:l()}).get(i).$promise;var a=e.defer();return a.resolve({endpoint:[]}),a.promise}function l(){return t.token()}function f(){return a.person(z.currentPersonId)}function g(r){if(!r)return s.organization(z.currentOrgId);var e=["admins","users","surveys","labels","questions","interaction_types"];return y({id:r.id,include:e.join(),organization_id:r.id}).then(function(r){var e=r.organization;s.organization(e),z.currentOrgId!==e.id&&(z.currentOrgId=e.id,n.$broadcast("current-org-updated",e))},function(n){i.error("Organization change failed because: "+n.statusText)})}function d(){var n=["all_organization_and_children","all_organizational_permissions","user","organizational_permission","permission","organizational_labels","label","interactions","email_addresses","phone_numbers","addresses"],r=e.defer();return m({id:"me",include:n.join()}).then(function(n){var e=n.person;z.currentPersonId=e.id,a.person(e),u.list(e.all_organization_and_children),g({id:e.user.primary_organization_id}).then(function(){r.resolve(e)},function(n){r.reject(n)})},function(n){i.error("Requesting your data failed due to: "+n),r.reject(n)}),r.promise}function m(n){var r=c("people",n);return r.then(function(n){angular.forEach(n.people,function(n){a.person(n)})}),r}function p(n){var r=["organizational_permission","permission","organizational_labels","label","email_addresses","phone_numbers","addresses"];return m({id:n,include:r.join()})}function h(n){var r=["answer_sheets","answers"];return m({id:n,include:r.join()})}function b(n){var r=["organizational_permission","permission","organizational_labels","label","email_addresses","phone_numbers","addresses","answer_sheets","answers","interactions","interaction_type"];return m({id:n,include:r.join()})}function _(n){return c("interactions",n)}function v(n){var r={"filters[people_ids]":n},e=["initiators","interaction_type","receiver","creator","last_updater"],i=angular.extend({include:e.join()},r);return _(i)}function y(n){return c("organizations",n)}var z={},I={currentPerson:f,currentOrg:g,people:{get:m,getMe:d,getPersonWithEverything:b,getPersonWithInfo:p,getPersonWithSurveyAnswers:h},interactions:{get:_,getInteractionsForPerson:v},organizations:{get:y}};return I}angular.module("missionhub.api").factory("api",n),n.$inject=["$rootScope","$resource","$q","$log","loginDetails","config","personCache","organizationCache","organizationListCache"]}(),function(){"use strict";function n(){function n(){return t}function r(n){e(n),t=n}function e(n){if(!n)throw new Error("InvalidGreeting");if(-1===n.search("%[sS]"))throw new Error("InvalidGreeting")}function i(n,r){function e(e){return n.debug(r("https://www.google.com").get()),t.replace(/%s/gi,function(n){return"%s"===n?e:i(e)})}function i(n){return(n||"").toUpperCase()}return{greet:e}}var t="Hello, %s.";return i.$inject=["$log","$resource"],{getGreeting:n,setGreeting:r,$get:i}}angular.module("missionhub.api").provider("api",n)}(),function(){"use strict";angular.module("missionhub.api").constant("config",{baseUrl:"https://stage.missionhub.com/apis/v3/"})}(),function(){"use strict";function n(){}angular.module("missionhub.api").config(n)}();