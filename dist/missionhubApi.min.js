!function(){"use strict";angular.module("missionhub.api",["restangular","missionhub.api.cache","missionhub.api.filters","missionhub.api.utils"])}(),function(){"use strict";function n(n,e){function t(e){var t={};return void 0!=e&&(t.order=e),t.include="person.first_name,person.email_addresses,person.phone_numbers",n.currentRestangular().all("people").getList(t)}function r(e){return n.currentRestangular().one("people",e).get()}function i(){return n.currentRestangular().one("people",e.getPersonId()).get()}function u(e){return n.currentRestangular().one("people",e).get({include:"email_addresses"})}function a(e){return n.currentRestangular().one("people",e).get({include:"interactions"})}var s={all:t,get:r,getWithEmails:u,getWithInteractions:a,current:i};return s}angular.module("missionhub.api").factory("people",n),n.$inject=["organizations","userDetails"]}(),function(){"use strict";function n(n,e){function t(){return a.allRestangular().getList()}function r(){return a.currentRestangular().get()}function i(){return n.all("organizations")}function u(){return n.one("organizations",e.getCurrentOrganization().id)}var a={all:t,current:r,allRestangular:i,currentRestangular:u};return a}angular.module("missionhub.api").factory("organizations",n),n.$inject=["Restangular","userDetails"]}(),function(){"use strict";angular.module("missionhub.api.utils",["LocalStorageModule"])}(),function(){"use strict";angular.module("missionhub.api.utils").constant("_",window._)}(),function(){"use strict";function n(n){function e(){return n.get("firstName")}function t(e){return n.set("firstName",e)}function r(){return n.get("lastName")}function i(e){return n.set("lastName",e)}function u(){return n.get("personId")}function a(e){return n.set("personId",e)}function s(){return n.get("profilePicture")}function o(e){return n.set("profilePicture",e)}function c(){return n.get("currentOrganization")}function l(e){return n.set("currentOrganization",e)}function f(){n.clearAll()}var g={getFirstName:e,setFirstName:t,getLastName:r,setLastName:i,getPersonId:u,setPersonId:a,getProfilePicture:s,setProfilePicture:o,getCurrentOrganization:c,setCurrentOrganization:l,clearAll:f};return g}angular.module("missionhub.api.utils").factory("userDetails",n),n.$inject=["localStorageService"]}(),function(){"use strict";function n(n,e){function t(e,t){a=t;var u=r(e.included);return n.isArray(e.data)?n(e.data).map(function(n){return i(n,u)}).value():i(e.data,u)}function r(e){return n(e).groupBy(function(n){return n.type}).mapValues(function(e){return n(e).mapKeys(function(n){return n.id}).mapValues(i).value()}).value()}function i(e,t){var r={};return r.id=e.id,r.type=e.type,r=n.merge(r,e.attributes),n.isObject(t)&&!n.isEmpty(t)&&(r=n.merge(r,u(e.relationships,t))),r}function u(t,r){return n(t).mapValues(function(t){return n(t.data).map(function(n){return void 0===r[n.type]||void 0===r[n.type][n.id]?void e.error("Deserializing response from",a+": Could not load data for relationship of type",n.type,"and id",n.id):r[n.type][n.id]}).value()}).value()}var a,s={deserialize:t,_indexIncludes:r,_flattenData:i,_findRelationships:u};return s}angular.module("missionhub.api.utils").factory("jsonapi",n),n.$inject=["_","$log"]}(),function(){"use strict";angular.module("missionhub.api.filters",[])}(),function(){"use strict";function n(){return function(n){if(!n)return"";var e=n.toString().trim().replace(/^\+/,"");if(e.match(/[^0-9]/))return n;var t,r,i;switch(e.length){case 10:t=1,r=e.slice(0,3),i=e.slice(3);break;case 11:t=e[0],r=e.slice(1,4),i=e.slice(4);break;case 12:t=e.slice(0,3),r=e.slice(3,5),i=e.slice(5);break;default:return n}return 1===t&&(t=""),i=i.slice(0,3)+"-"+i.slice(3),(t+" ("+r+") "+i).trim()}}angular.module("missionhub.api.filters").filter("tel",n)}(),function(){"use strict";function n(n,e){return function(t){if(!t)return"";var r=n.currentOrg(),i=e.find(r.surveys,{id:t.survey_id});return e.result(i,"title","")}}angular.module("missionhub.api.filters").filter("surveyName",n),n.$inject=["api","lodash"]}(),function(){"use strict";function n(){return function(n){if(!n||!n.phone_numbers||0===n.phone_numbers.length)return"";for(var e=0;e<n.phone_numbers.length;){if(n.phone_numbers[e].primary)return n.phone_numbers[e].number;e++}return n.phone_numbers[0].number}}angular.module("missionhub.api.filters").filter("personPrimaryPhone",n)}(),function(){"use strict";function n(){return function(n){return n&&n.first_name?n.first_name+" "+n.last_name:""}}angular.module("missionhub.api.filters").filter("personFullname",n)}(),function(){"use strict";function n(){return function(n,e){if(e=e||40,!n||!n.first_name)return"";if(n.picture)return n.picture+"?width="+e+"&height="+e;for(var t="444444",r=0,i=0;r<n.first_name.length;i=n.first_name.charCodeAt(r++)+((i<<5)-i));for(var r=0,t="";3>r;t+=("00"+(i>>8*r++&255).toString(16)).slice(-2));return"https://avatars.discourse.org/letter/"+n.first_name.slice(0,1)+"/"+t+"/"+e+".png"}}angular.module("missionhub.api.filters").filter("personAvatar",n)}(),function(){"use strict";function n(){return function(n){return n?n.initiators[0]?n.initiators[0]:n.creator?n.creator:{}:{}}}angular.module("missionhub.api.filters").filter("interactionPrimaryInitiator",n)}(),function(){"use strict";function n(){return function(n){var e="http://maps.google.com/maps?q=";return n.address1&&(e+=n.address1+"+"),n.address2&&(e+=n.address2+"+"),n.city&&(e+=n.city+",+"),n.state&&(e+=n.state+"+"),n.country&&(e+=n.country),e.lastIndexOf("+")===e.length-1&&(e=e.slice(0,-1)),e}}angular.module("missionhub.api.filters").filter("googleMapsAddress",n)}(),function(){"use strict";function n(){return function(n){return"background-image: url("+n+")"}}angular.module("missionhub.api.filters").filter("backgroundStyle",n)}(),function(){"use strict";angular.module("missionhub.api.cache",[])}(),function(){"use strict";function n(){function n(n){return n.id?(e[n.id]=e[n.id]||{},angular.merge(e[n.id],n),!0):e[n]}var e={};return{person:n}}angular.module("missionhub.api.cache").factory("personCache",n)}(),function(){"use strict";function n(){function n(n){return n.id?(e[n.id]=e[n.id]||{},angular.merge(e[n.id],n),!0):e[n]}var e={};return{organization:n}}angular.module("missionhub.api.cache").factory("organizationCache",n)}(),function(){"use strict";function n(){function n(n){return n&&n.length?0===n.length?0===e.length:(e=[],angular.merge(e,n),!0):angular.extend([],e)}var e=[];return{list:n}}angular.module("missionhub.api.cache").factory("organizationListCache",n)}(),function(){"use strict";function n(n,e){function t(n,e,t,i){function u(){n.addResponseInterceptor(function(n,t,r,i){return e.deserialize(n,i)})}var a={baseUrl:r.baseUrl,people:{all:t.all,current:t.current,get:t.get},organizations:{all:i.all,current:i.current}};return u(),a}var r={$get:t};return Object.defineProperties(r,{baseUrl:{get:function(){return n.baseUrl},set:function(t){n.baseUrl=t,e.setBaseUrl(t)}}}),t.$inject=["Restangular","jsonapi","people","organizations"],r}angular.module("missionhub.api").provider("api",n),n.$inject=["apiConfig","RestangularProvider"]}(),function(){"use strict";angular.module("missionhub.api").constant("_",window._).constant("apiConfig",{baseUrl:"/"})}(),function(){"use strict";function n(n){n.setPrefix("mh.user")}angular.module("missionhub.api").config(n),n.$inject=["localStorageServiceProvider"]}();